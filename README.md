# Медицинский калькулятор (ИМТ) — React Native / Expo

Мобильное приложение для расчёта индекса массы тела (ИМТ) с интерпретацией результата, сохранением истории и статистикой времени использования. Дополнительно реализована интеграция с внешним сервисом: поиск публикаций в PubMed через NCBI E-utilities API.

## Основные возможности
- **Анкета**: ввод веса (кг) и роста (см) с валидацией диапазонов
- **Расчёт**: ИМТ по формуле `ИМТ = вес / рост²` (рост в метрах)
- **Интерпретация**: классификация результата по шкале ВОЗ для взрослых
- **История**: сохранение последних 50 расчётов (AsyncStorage)
- **Статистика**: учёт времени использования приложения и отдельных разделов
- **Справочник**: поиск статей в PubMed (требуется интернет)

## Запуск (разработка)
1. Установите Node.js (LTS) и зависимости:
   ```bash
   npm install
   ```
2. Запустите:
   ```bash
   npm start
   ```
3. Откройте приложение через **Expo Go** (телефон) или эмулятор/симулятор.

## Web-версия

### Запуск в браузере
```bash
npm run web
```

### Экспорт статической сборки (для Netlify/Vercel/static-хостинга)
```bash
npm run export:web
```

> На web учёт времени использования дополнительно учитывает переключение вкладок браузера (через `document.visibilitychange`).

## Сборка APK (варианты)
### Вариант A — через EAS Build (рекомендуется)
1. Установите EAS CLI:
   ```bash
   npm i -g eas-cli
   ```
2. Авторизуйтесь:
   ```bash
   eas login
   ```
3. Запустите сборку APK:
   ```bash
   eas build -p android --profile preview
   ```

### Вариант B — локальная сборка (Android Studio)
Требуется установленный Android SDK и Gradle. Для managed-проекта Expo обычно проще использовать EAS Build.

## Важно
- Приложение не является медицинским изделием. Результаты носят информационный характер.
- Для корректного взаимодействия с NCBI рекомендуется указать реальный контактный email в `src/api/pubmed.ts` (параметр `email`).
## Backend (PostgreSQL) — индивидуальная история пользователей

В этой версии:
- Регистрация/вход работают через backend API.
- История ИМТ хранится в PostgreSQL и привязана к конкретному пользователю.

### 1) Запуск PostgreSQL (через Docker)
В корне проекта:
```bash
docker compose up -d
```

База будет доступна на `localhost:5432`, база `fitness_bmi`, пользователь/пароль `postgres/postgres`.

### 2) Запуск API-сервера
```bash
cd server
cp .env.example .env
npm install
npm run start
```

Сервер стартует на `http://localhost:3001`.

### 3) Запуск приложения
В отдельном терминале (из корня проекта):
```bash
npm install
npx expo start --web
```

### Администратор
По умолчанию (см. `server/.env`):
- email: `admin@fitness.local`
- пароль: `admin12345`

Эти значения можно изменить в `.env`.
